/*! For license information please see renderer.umd.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.aipageWidget=t():e.aipageWidget=t()}(this,(function(){return function(){var e={404:function(){},513:function(){},744:function(e,t){"use strict";t.Z=(e,t)=>{const r=e.__vccOpts||e;for(const[e,n]of t)r[e]=n;return r}},918:function(e,t,r){var n=r(404);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals),(0,r(346).Z)("090d7aa3",n,!1,{sourceMap:!1})},474:function(e,t,r){var n=r(513);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals),(0,r(346).Z)("03544ffa",n,!1,{sourceMap:!1})},346:function(e,t,r){"use strict";function n(e,t){for(var r=[],n={},s=0;s<t.length;s++){var o=t[s],i=o[0],a={id:e+":"+s,css:o[1],media:o[2],sourceMap:o[3]};n[i]?n[i].parts.push(a):r.push(n[i]={id:i,parts:[a]})}return r}r.d(t,{Z:function(){return m}});var s="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!s)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var o={},i=s&&(document.head||document.getElementsByTagName("head")[0]),a=null,l=0,c=!1,u=function(){},p=null,d="data-vue-ssr-id",f="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function m(e,t,r,s){c=r,p=s||{};var i=n(e,t);return h(i),function(t){for(var r=[],s=0;s<i.length;s++){var a=i[s];(l=o[a.id]).refs--,r.push(l)}for(t?h(i=n(e,t)):i=[],s=0;s<r.length;s++){var l;if(0===(l=r[s]).refs){for(var c=0;c<l.parts.length;c++)l.parts[c]();delete o[l.id]}}}}function h(e){for(var t=0;t<e.length;t++){var r=e[t],n=o[r.id];if(n){n.refs++;for(var s=0;s<n.parts.length;s++)n.parts[s](r.parts[s]);for(;s<r.parts.length;s++)n.parts.push(g(r.parts[s]));n.parts.length>r.parts.length&&(n.parts.length=r.parts.length)}else{var i=[];for(s=0;s<r.parts.length;s++)i.push(g(r.parts[s]));o[r.id]={id:r.id,refs:1,parts:i}}}}function v(){var e=document.createElement("style");return e.type="text/css",i.appendChild(e),e}function g(e){var t,r,n=document.querySelector("style["+d+'~="'+e.id+'"]');if(n){if(c)return u;n.parentNode.removeChild(n)}if(f){var s=l++;n=a||(a=v()),t=L.bind(null,n,s,!1),r=L.bind(null,n,s,!0)}else n=v(),t=k.bind(null,n),r=function(){n.parentNode.removeChild(n)};return t(e),function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap)return;t(e=n)}else r()}}var y,b=(y=[],function(e,t){return y[e]=t,y.filter(Boolean).join("\n")});function L(e,t,r,n){var s=r?"":n.css;if(e.styleSheet)e.styleSheet.cssText=b(t,s);else{var o=document.createTextNode(s),i=e.childNodes;i[t]&&e.removeChild(i[t]),i.length?e.insertBefore(o,i[t]):e.appendChild(o)}}function k(e,t){var r=t.css,n=t.media,s=t.sourceMap;if(n&&e.setAttribute("media",n),p.ssrId&&e.setAttribute(d,t.id),s&&(r+="\n/*# sourceURL="+s.sources[0]+" */",r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */"),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}}},t={};function r(n){var s=t[n];if(void 0!==s)return s.exports;var o=t[n]={id:n,exports:{}};return e[n](o,o.exports,r),o.exports}r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};return function(){"use strict";r.r(n);var e=require("vue3-aipage-widget"),t=require("vue"),s={class:"content"},o={class:"sm"},i=[(0,t.createElementVNode)("span",null,"开 始",-1)],a={class:"shell"},l={class:"l"},c={class:"c"},u={class:"HMSM"},p={class:"HMSM-display-bg"},d={class:"HMSM-display"},f=["src"],m={class:"r"},h={name:"LotteryMachine",data:function(){return{delay:0,duration:0,direction:"up",rollState:"stop",prizeList:[],translateY:[0,0,0],shaftList:[],lampTimer:!1,lamps:[{color:"#97eefb"},{color:"#fecc6a"},{color:"#fb7c84"},{color:"#a097ff"},{color:"#fd0100"}]}},emits:["init","roll"],methods:{init:function(e){var t=this,r=e.prizeList,n=e.defaultResults,s=void 0===n?[]:n,o=e.delay,i=void 0===o?500:o,a=e.duration,l=void 0===a?4e3:a,c=e.direction,u=void 0===c?"up":c;if("number"!=typeof i&&(console.warn("delay参数应该传入整型"),i=parseInt(i),i=isNaN(i)?500:i),"number"!=typeof l&&(console.warn("duration参数应该传入整型"),l=parseInt(l),l=isNaN(l)?4e3:l),"object"!=typeof r)return console.error("prizeList参数应该传入数组对象");if("object"!=typeof s)return console.error("defaultResults参数应该传入数组");if("up"!=u&&"down"!=u)return console.error('direction参数应该传入"up"或者"down"');this.direction=u,l<4e3&&(l=4e3),l-=2*i,this.prizeList=r;var p=[];p.length=3;for(var d=0;d<3;d++){p[d]=this.shuffle(r);for(var f=0,m=p[d].length;f<m;f++)p[d][f].HMSM_id="id_"+d+"_"+f}if(this.shaftList=p,3==s.length&&(this.setTranslateY(s),setTimeout((function(){t.stop()}),50)),"down"==this.direction){var h=-100*(this.shaftList[1].length-1);this.translateY.splice(0,3,h,h,h)}this.$nextTick((function(){this.duration=l,this.delay=i}))},roll:function(e){var t=this,r=e.results,n=void 0===r?null:r,s=e.success,o=void 0===s?null:s;if("start"==this.rollState)return console.warn("正在抽奖哦！");if("object"!=typeof n)return console.error("请传入正确的开奖结果参数results");this.rollState="start";var i=this.setTranslateY(n);this.lampTimer&&clearInterval(this.lampTimer),this.startSwitchLamp(),setTimeout((function(){"function"==typeof o&&o(i),t.stop()}),this.duration+1e3)},setTranslateY:function(e){var t=this,r={results:[]};console.log("results: ",e);for(var n=function(n,s){if("up"==t.direction)for(var o=function(s){if(t.shaftList[n][s].value==e[n])return r.results.push(JSON.parse(JSON.stringify(t.shaftList[n][s]))),setTimeout((function(){t.translateY.splice(n,1,-100*s)}),n*t.delay),"break"},i=t.shaftList[n].length-1;i>=0&&"break"!==o(i);i--);else for(var a=function(s,o){if(t.shaftList[n][s].value==e[n])return r.results.push(JSON.parse(JSON.stringify(t.shaftList[n][s]))),setTimeout((function(){t.translateY.splice(n,1,-100*s)}),n*t.delay),"break"},l=0,c=t.shaftList[n].length;l<c&&"break"!==a(l);l++);},s=0,o=e.length;s<o;s++)n(s);return r},stop:function(){this.rollState="stop",this.lampTimer&&clearInterval(this.lampTimer),this.$nextTick((function(){var e=(this.shaftList[0].length/this.prizeList.length-1)*this.prizeList.length*100;e="up"==this.direction&&e||-e;for(var t=0,r=this.translateY.length;t<r;t++){var n=this.translateY[t]+e;this.translateY.splice(t,1,n)}}))},startSwitchLamp:function(){var e=this;this.lampTimer=setInterval((function(){if("stop"!=e.rollState)if("up"==e.direction?e.lamps.push(e.lamps.shift()):e.lamps.unshift(e.lamps.pop()),"up"==e.direction){var t=e.lamps[0],r=[e.lamps[1],e.lamps[2],e.lamps[3],e.lamps[4]];e.lamps[0]=r[0],e.lamps[1]=r[1],e.lamps[2]=r[2],e.lamps[3]=r[3],e.$nextTick((function(){this.lamps[4]=t}))}else{var n=e.lamps[4],s=[e.lamps[0],e.lamps[1],e.lamps[2],e.lamps[3]];e.lamps[1]=s[0],e.lamps[2]=s[1],e.lamps[3]=s[2],e.lamps[4]=s[3],e.$nextTick((function(){this.lamps[0]=n}))}}),50)},shuffle:function(e){for(var t=JSON.parse(JSON.stringify(e)),r=1;r<t.length;r++){var n=Math.floor(Math.random()*(r+1)),s=[t[n],t[r]];t[r]=s[0],t[n]=s[1]}for(var o=Math.ceil(40/e.length),i=[];o>0;)i.push.apply(i,t),o--;return JSON.parse(JSON.stringify(i))}}},v=(r(918),r(744)),g={props:["componentProperties"],data:function(){return{defaultPrizeList:[{name:"iPhone13",value:"iPhone",img:"https://user-images.githubusercontent.com/11958920/184317722-f7a110f8-0084-4b6b-b49d-309ede05b14a.png"},{name:"airPods3",value:"airPods",img:"https://user-images.githubusercontent.com/11958920/184317817-0d64d28d-20cf-4975-9a07-7a16e70f85bf.png"},{name:"行李箱",value:"luggage",img:"https://user-images.githubusercontent.com/11958920/184317875-20c2df50-6901-4364-b3c7-e086bb717a72.png"},{name:"风筒",value:"dryer",img:"https://user-images.githubusercontent.com/11958920/184317938-03c2cc33-948d-45e6-8eba-1b473966ea1e.png"},{name:"平行车",value:"balanceCar",img:"https://user-images.githubusercontent.com/11958920/184317959-9a38abd1-12da-43fa-b93a-eb3e0fbc1ed1.png"},{name:"iPad5",value:"iPad",img:"https://user-images.githubusercontent.com/11958920/184317974-d0f9d220-b0eb-4596-9e9b-84767dee8b8c.png"}]}},computed:{prizeList:function(){return this.componentProperties&&this.componentProperties.data&&this.componentProperties.data.prizeList||this.defaultPrizeList}},components:{LotteryMachine:(0,v.Z)(h,[["render",function(e,r,n,s,o,i){return(0,t.openBlock)(),(0,t.createElementBlock)("div",a,[(0,t.createElementVNode)("div",l,[(0,t.createCommentVNode)(" 小灯列表 "),((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(o.lamps,(function(e,r){return(0,t.openBlock)(),(0,t.createElementBlock)("div",{class:"lamp",key:e.color,style:(0,t.normalizeStyle)({"background-color":e.color,"box-shadow":"0 0 5px "+e.color})},null,4)})),128))]),(0,t.createElementVNode)("div",c,[(0,t.createElementVNode)("div",u,[(0,t.createCommentVNode)(" 背景 "),(0,t.createElementVNode)("div",p,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(o.shaftList,(function(e,r){return(0,t.openBlock)(),(0,t.createElementBlock)("div",{key:r,class:"box"})})),128))]),(0,t.createCommentVNode)(" 奖品列表 "),(0,t.createElementVNode)("div",d,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(o.shaftList,(function(e,r){return(0,t.openBlock)(),(0,t.createElementBlock)("div",{key:r,class:(0,t.normalizeClass)(["HMSM-shaft",{roll_animation:"start"==o.rollState}]),style:(0,t.normalizeStyle)({transform:"translate3d(0, "+o.translateY[r]+"%, 0)","transition-duration":o.duration+"ms"})},[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(e,(function(e,r){return(0,t.openBlock)(),(0,t.createElementBlock)("div",{key:e.HMSM_id},[(0,t.createElementVNode)("img",{src:e.img},null,8,f)])})),128))],6)})),128))])])]),(0,t.createElementVNode)("div",m,[(0,t.createCommentVNode)(" 小灯列表 "),((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(o.lamps,(function(e,r){return(0,t.openBlock)(),(0,t.createElementBlock)("div",{class:"lamp",key:e.color,style:(0,t.normalizeStyle)({"background-color":e.color,"box-shadow":"0 0 5px "+e.color})},null,4)})),128))])])}],["__scopeId","data-v-c331e2e0"]])},mounted:function(){this.$refs.LotteryMachine.init({prizeList:this.prizeList,defaultResults:["iPhone","iPhone","iPhone"],duration:4e3,direction:"up"})},methods:{start:function(){this.$refs.LotteryMachine.roll({results:this.getResults(),success:function(e){console.log("success e: ",e)}})},getResults:function(){console.log("this.prizeList:",this.prizeList),console.log("this.prizeList1:",this.prizeList[0]);var e=this.prizeList.length-1,t=[Math.floor(Math.random()*(e-1+1)+1),Math.floor(Math.random()*(e-1+1)+1),Math.floor(Math.random()*(e-1+1)+1)];return[this.prizeList[t[0]].value,this.prizeList[t[1]].value,this.prizeList[t[2]].value]}}};r(474);const y=(0,v.Z)(g,[["render",function(e,r,n,a,l,c){var u=(0,t.resolveComponent)("LotteryMachine");return(0,t.openBlock)(),(0,t.createElementBlock)("div",s,[(0,t.createElementVNode)("div",o,[(0,t.createVNode)(u,{ref:"LotteryMachine"},null,512)]),(0,t.createElementVNode)("div",{class:"start",onClick:r[0]||(r[0]=function(){return c.start&&c.start.apply(c,arguments)})},i)])}]]);var b=y;(0,e.registerRenderer)(b,{type:"uni-lottery-card",framework:"vue3"})}(),n}()}));